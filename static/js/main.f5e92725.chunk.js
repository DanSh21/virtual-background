(this["webpackJsonpvirtual-background"]=this["webpackJsonpvirtual-background"]||[]).push([[0],{330:function(e,t,n){},331:function(e,t,n){},336:function(e,t){},337:function(e,t){},345:function(e,t){},348:function(e,t){},349:function(e,t){},350:function(e,t,n){"use strict";n.r(t);var r=n(22),o=n(403),a=n(7),c=n.n(a),i=n(50),s=n.n(i),u=n(60),l=n(5),d=n(395),b=n(406),g=(n(397),n(398),n(353),n(228)),f=n.n(g),p=n(229),j=n.n(p),m=["architecture-5082700_1280","porch-691330_1280","saxon-switzerland-539418_1280","shibuyasky-4768679_1280"].map((function(e){return"".concat("/virtual-background","/backgrounds/").concat(e,".jpg")})),h=n(4),O=n.n(h),v=n(12);n(396);var x=n(26);n(391);Object(d.a)((function(e){return Object(b.a)({root:{padding:0,minWidth:e.spacing(7)+2,height:e.spacing(7)+2,width:e.spacing(7)+2,marginRight:e.spacing(1),marginBottom:e.spacing(1),border:"2px solid transparent",alignItems:"stretch",transitionProperty:"transform, border-color",transitionDuration:"".concat(e.transitions.duration.shorter,"ms"),transitionTimingFunction:e.transitions.easing.easeInOut,"&:hover":{transform:"scale(1.125)"}},active:{borderColor:e.palette.primary.main,transform:"scale(1.125)"}})}));Object(d.a)((function(e){return Object(b.a)({scalableContent:{width:"calc(100% + 2px)",height:"calc(100% + 2px)",margin:-1,borderRadius:e.shape.borderRadius},image:{objectFit:"cover"}})}));Object(d.a)((function(e){return Object(b.a)({root:{width:"100%",height:"100%",borderWidth:1,borderStyle:"solid",borderColor:"rgba(0, 0, 0, 0.23)",borderRadius:e.shape.borderRadius,margin:-1,boxSizing:"content-box",display:"flex",justifyContent:"center",alignItems:"center"}})}));Object(d.a)((function(e){return Object(b.a)({root:{flex:1}})})),n(399),n(405);n(187),n(400),n(407),n(408),n(404);Object(d.a)((function(e){return Object(b.a)({root:Object(u.a)({},e.breakpoints.only("md"),{gridColumnStart:2,gridRowStart:2}),formControl:{marginTop:e.spacing(1),marginBottom:e.spacing(1),marginRight:e.spacing(2),minWidth:120}})})),n(289);var y=["girl-919048_1280","doctor-5871743_640","woman-5883428_1280"].map((function(e){return"".concat("/virtual-background","/images/").concat(e,".jpg")}));["Dance - 32938","Doctor - 26732","Thoughtful - 35590"].map((function(e){return"".concat("/virtual-background","/videos/").concat(e,".mp4")})),n(288);Object(d.a)((function(e){return Object(b.a)({icon:{position:"absolute",bottom:0,right:0,color:e.palette.common.white}})}));Object(d.a)((function(e){return Object(b.a)({root:{flex:1}})}));var w=n(290),C=n.n(w);var k=function(){var e=Object(a.useRef)(null);return Object(a.useEffect)((function(){function t(){return(t=Object(v.a)(O.a.mark((function t(){var n,r;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={video:!0},t.next=4,navigator.mediaDevices.getUserMedia(n);case 4:r=t.sent,e.current.srcObject=r,t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("Error opening video camera.",t.t0),alert("Error opening video camera. ".concat(t.t0));case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),e};var I=function(){var e=Object(a.useState)(0),t=Object(l.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)([]),c=Object(l.a)(o,2),i=c[0],s=c[1],u=Object(a.useRef)(0),d=Object(a.useRef)(0),b=Object(a.useRef)([]),g=Object(a.useRef)(0),f=Object(a.useRef)(0);return{fps:n,durations:i,beginFrame:Object(a.useCallback)((function(){d.current=Date.now()}),[]),addFrameEvent:Object(a.useCallback)((function(){var e=Date.now();b.current[g.current]=e-d.current,d.current=e,g.current++}),[]),endFrame:Object(a.useCallback)((function(){var e=Date.now();b.current[g.current]=e-d.current,f.current++,e>=u.current+1e3&&(r(1e3*f.current/(e-u.current)),s(b.current),u.current=e,f.current=0),g.current=0}),[])}};var _=function(e){var t=Object(a.useState)(0),n=Object(l.a)(t,2),r=n[0],o=n[1],c=Object(a.useState)(0),i=Object(l.a)(c,2),s=i[0],u=i[1];return Object(a.useEffect)((function(){if(e.current){var t=e.current;return console.log("Listening for video resize"),t.addEventListener("resize",n),function(){t.removeEventListener("resize",n)}}function n(){console.log("Video was resized"),o(t.videoWidth),u(t.videoHeight)}}),[e]),{videoWidth:r,videoHeight:s}};n(330);var R=function(e){return Object(r.jsx)("button",{className:Object(x.a)("VideoControl",e.isActivated&&"VideoControl-activated"),onClick:e.onClick,children:e.children})};n(331);var S=function(e){var t=Object(a.useRef)(null),n=Object(a.useRef)(null),o=Object(a.useRef)(null),c=k(),i=_(c),s=i.videoWidth,u=i.videoHeight,d=Object(a.useState)(!1),b=Object(l.a)(d,2),g=b[0],p=b[1],m=Object(a.useState)("none"),h=Object(l.a)(m,2),x=h[0],y=h[1],w=I(),S=w.fps,F=Object(l.a)(w.durations,2),P=F[0],E=F[1],D=w.beginFrame,L=w.addFrameEvent,M=w.endFrame;return Object(a.useEffect)((function(){if(g){var r=t.current.getContext("2d"),a=n.current.getContext("2d"),i=new ImageData(s,u),l=s*u,d=o.current.naturalWidth,b=o.current.naturalHeight,f=Math.max(1,s/d,u/b);d*=f,b*=f;var p,j=!0;return m(),console.log("Animation started:",x),function(){j=!1,cancelAnimationFrame(p),console.log("Animation stopped:",x)}}function m(){return h.apply(this,arguments)}function h(){return(h=Object(v.a)(O.a.mark((function t(){var s,u;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(j){t.next=2;break}return t.abrupt("return");case 2:if(D(),"none"===x){t.next=9;break}return t.next=6,e.bodyPixNeuralNetwork.segmentPerson(c.current);case 6:for(s=t.sent,u=0;u<l;u++)i.data[4*u+3]=s.data[u]?255:0;a.putImageData(i,0,0);case 9:L(),"blur"===x?(r.globalCompositeOperation="copy",r.filter="blur(8px)",r.drawImage(n.current,0,0),r.globalCompositeOperation="source-out",r.drawImage(c.current,0,0),r.globalCompositeOperation="destination-over",r.filter="none"):"image"===x?(r.globalCompositeOperation="copy",r.filter="blur(2px)",r.drawImage(n.current,0,0),r.globalCompositeOperation="source-out",r.filter="none",r.drawImage(o.current,0,0,d,b),r.globalCompositeOperation="destination-over"):r.globalCompositeOperation="source-over",r.drawImage(c.current,0,0),M(),p=requestAnimationFrame(m);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}}),[e.bodyPixNeuralNetwork,c,x,s,u,g,D,L,M]),Object(r.jsx)("div",{className:"VideoPlayer",children:Object(r.jsxs)("div",{className:"VideoPlayer-root",children:[Object(r.jsxs)("div",{className:"VideoPlayer-stats",children:[Object(r.jsxs)("span",{children:[Math.round(S)," fps"]})," (",Object(r.jsxs)("span",{children:["inference ",P,"ms"]}),","," ",Object(r.jsxs)("span",{children:["post-processing ",E,"ms"]}),")"]}),Object(r.jsx)("video",{ref:c,width:s,height:u,autoPlay:!0,playsInline:!0,controls:!1,hidden:!0,onLoadedData:function(){return p(!0)},onAbort:function(){return p(!1)}}),Object(r.jsx)("img",{ref:o,src:"".concat("/virtual-background","/backgrounds/trees-4830285_640.jpg"),alt:"",hidden:!0}),Object(r.jsx)("canvas",{ref:n,width:s,height:u,hidden:!0}),Object(r.jsx)("canvas",{ref:t,className:"VideoPlayer-video",width:s,height:u}),Object(r.jsxs)("div",{className:"VideoPlayer-controls",children:[Object(r.jsx)(R,{isActivated:"none"===x,onClick:function(){return y("none")},children:Object(r.jsx)(f.a,{})}),Object(r.jsx)(R,{isActivated:"blur"===x,onClick:function(){return y("blur")},children:Object(r.jsx)(j.a,{})}),Object(r.jsx)(R,{isActivated:"image"===x,onClick:function(){return y("image")},children:Object(r.jsx)(C.a,{})})]})]})})};n(409),n(402),n(352);Object(d.a)((function(e){return Object(b.a)({render:{position:"absolute",width:"100%",height:"100%",objectFit:"cover"},stats:{position:"absolute",top:0,right:0,left:0,textAlign:"center",backgroundColor:"rgba(0, 0, 0, 0.48)",color:e.palette.common.white}})})),n(401),n(291);Object(d.a)((function(e){return Object(b.a)({sourcePlayback:{position:"absolute",width:"100%",height:"100%",objectFit:"cover"}})}));Object(d.a)((function(e){var t,n=["".concat(e.spacing(52),"px"),"100vh - ".concat(e.spacing(2),"px")];return Object(b.a)({root:(t={minHeight:"calc(min(".concat(n.join(", "),"))"),display:"flex",overflow:"hidden"},Object(u.a)(t,e.breakpoints.up("md"),{gridColumnStart:1,gridColumnEnd:3}),Object(u.a)(t,e.breakpoints.up("lg"),{gridRowStart:1,gridRowEnd:3}),t),sourceCell:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center",borderRightWidth:1,borderRightStyle:"solid",borderRightColor:e.palette.divider},outputCell:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center"},avatar:{width:e.spacing(20),height:e.spacing(20)}})}));var F=n(292),P=n(312);var E=function(){var e=Object(a.useState)(),t=Object(l.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){function e(){return(e=Object(v.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Loading TensorFlow.js and BodyPix segmentation model"),e.next=3,P.a();case 3:return e.t0=r,e.next=6,F.a();case 6:e.t1=e.sent,(0,e.t0)(e.t1),console.log("TensorFlow.js and BodyPix loaded");case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),n};var D=function(){Object(a.useEffect)((function(){function e(){return(e=Object(v.a)(O.a.mark((function e(){var t,n,r,o,a,c,i,s,u;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,createTFLiteModule();case 2:return t=e.sent,e.next=5,fetch("".concat("/virtual-background","/models/segm_lite_v681.tflite"));case 5:return n=e.sent,e.next=8,n.arrayBuffer();case 8:return r=e.sent,console.log("Lite model buffer size:",r.byteLength),e.next=12,fetch("".concat("/virtual-background","/models/segm_full_v679.tflite"));case 12:return o=e.sent,e.next=15,o.arrayBuffer();case 15:a=e.sent,console.log("Full model buffer size:",a.byteLength),c=t._getModelBufferMemoryOffset(),console.log("Model buffer memory offset:",c),console.log("Loading light model buffer..."),t.HEAPU8.set(new Uint8Array(r),c),console.log("_loadModel result:",t._loadModel(r.byteLength)),console.log("Input memory offset:",t._getInputMemoryOffset()),console.log("Input height:",t._getInputHeight()),console.log("Input width:",t._getInputWidth()),console.log("Input channels:",t._getInputChannelCount()),console.log("Output memory offset:",t._getOutputMemoryOffset()),console.log("Output height:",t._getOutputHeight()),console.log("Output width:",t._getOutputWidth()),console.log("Output channels:",t._getOutputChannelCount()),i=Date.now(),s=t._runInference(),u=Date.now()-i,console.log("_runInference result: ".concat(s," (").concat(u,"ms)"));case 34:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[])};var L=Object(d.a)((function(e){var t;return Object(b.a)({root:(t={display:"grid"},Object(u.a)(t,e.breakpoints.up("xs"),{margin:e.spacing(1),gap:e.spacing(1),gridTemplateColumns:"1fr"}),Object(u.a)(t,e.breakpoints.up("md"),{margin:e.spacing(2),gap:e.spacing(2),gridTemplateColumns:"repeat(2, 1fr)"}),Object(u.a)(t,e.breakpoints.up("lg"),{gridTemplateColumns:"repeat(3, 1fr)"}),t),resourceSelectionCards:{display:"flex",flexDirection:"column"}})})),M=function(){var e=E();D(),L();var t=Object(a.useState)({type:"image",url:y[0]}),n=Object(l.a)(t,2),o=(n[0],n[1],Object(a.useState)({type:"image",url:m[0]})),c=Object(l.a)(o,2),i=(c[0],c[1],Object(a.useState)({model:"bodyPix",inputResolution:"360p"})),s=Object(l.a)(i,2),u=(s[0],s[1],Object(a.useState)({smoothSegmentationMask:!0})),d=Object(l.a)(u,2);return d[0],d[1],e?Object(r.jsx)(S,{bodyPixNeuralNetwork:e}):null},A=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,411)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),r(e),o(e),a(e),c(e)}))};s.a.render(Object(r.jsxs)(c.a.StrictMode,{children:[Object(r.jsx)(o.a,{}),Object(r.jsx)(M,{})]}),document.getElementById("root")),A()}},[[350,1,2]]]);
//# sourceMappingURL=main.f5e92725.chunk.js.map