(this["webpackJsonpvirtual-background"]=this["webpackJsonpvirtual-background"]||[]).push([[0],{260:function(e,t,n){},261:function(e,t,n){},266:function(e,t){},267:function(e,t){},275:function(e,t){},278:function(e,t){},279:function(e,t){},280:function(e,t,n){},281:function(e,t,n){"use strict";n.r(t);var r=n(47),a=n(39),c=n.n(a),o=n(232),i=n.n(o),s=n(4),u=n.n(s),l=n(11),d=n(6),b=n.p+"static/media/800px-Main_Control_Room_at_ESA's_Space_Operations_Centre_ESA11252261.7973a2b2.jpg";var f=function(){var e=Object(a.useRef)(null);return Object(a.useEffect)((function(){function t(){return(t=Object(l.a)(u.a.mark((function t(){var n,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={video:!0},t.next=4,navigator.mediaDevices.getUserMedia(n);case 4:r=t.sent,e.current.srcObject=r,t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("Error opening video camera.",t.t0),alert("Error opening video camera. ".concat(t.t0));case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),e};var j=function(){var e=Object(a.useState)(0),t=Object(d.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)([]),o=Object(d.a)(c,2),i=o[0],s=o[1],u=Object(a.useRef)(0),l=Object(a.useRef)(0),b=Object(a.useRef)([]),f=Object(a.useRef)(0),j=Object(a.useRef)(0);return{fps:n,durations:i,beginFrame:Object(a.useCallback)((function(){l.current=Date.now()}),[]),addFrameEvent:Object(a.useCallback)((function(){var e=Date.now();b.current[f.current]=e-l.current,l.current=e,f.current++}),[]),endFrame:Object(a.useCallback)((function(){var e=Date.now();b.current[f.current]=e-l.current,j.current++,e>=u.current+1e3&&(r(1e3*j.current/(e-u.current)),s(b.current),u.current=e,j.current=0),f.current=0}),[])}};var p=function(e){var t=Object(a.useState)(0),n=Object(d.a)(t,2),r=n[0],c=n[1],o=Object(a.useState)(0),i=Object(d.a)(o,2),s=i[0],u=i[1];return Object(a.useEffect)((function(){if(e.current){var t=e.current;return console.log("Listening for video resize"),t.addEventListener("resize",n),function(){t.removeEventListener("resize",n)}}function n(){console.log("Video was resized"),c(t.videoWidth),u(t.videoHeight)}}),[e]),{videoWidth:r,videoHeight:s}};n(260);var v=function(e){return Object(r.jsx)("button",{className:"VideoControl ".concat(e.isActivated?"VideoControl-activated":""),onClick:e.onClick,children:e.iconName})};n(261);var O=function(e){var t=Object(a.useRef)(null),n=Object(a.useRef)(null),c=f(),o=p(c),i=o.videoWidth,s=o.videoHeight,O=Object(a.useState)(!1),m=Object(d.a)(O,2),g=m[0],h=m[1],x=Object(a.useState)("none"),w=Object(d.a)(x,2),k=w[0],C=w[1],y=j(),N=y.fps,F=Object(d.a)(y.durations,2),E=F[0],P=F[1],S=y.beginFrame,A=y.addFrameEvent,_=y.endFrame;return Object(a.useEffect)((function(){if(g){var r,a=t.current.getContext("2d"),o=new ImageData(i,s),d=i*s,b=!0;return f(),console.log("Animation started:",k),function(){b=!1,cancelAnimationFrame(r),console.log("Animation stopped:",k)}}function f(){return j.apply(this,arguments)}function j(){return(j=Object(l.a)(u.a.mark((function t(){var i,s;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(b){t.next=2;break}return t.abrupt("return");case 2:if(S(),"none"===k){t.next=8;break}return t.next=6,e.bodyPixNeuralNetwork.segmentPerson(c.current);case 6:for(i=t.sent,s=0;s<d;s++)o.data[4*s+3]=i.data[s]?255:0;case 8:A(),"blur"===k?(a.putImageData(o,0,0),a.globalCompositeOperation="source-out",a.filter="blur(4px)",a.drawImage(c.current,0,0),a.globalCompositeOperation="destination-over",a.filter="none"):"image"===k?(a.putImageData(o,0,0),a.globalCompositeOperation="source-out",a.drawImage(n.current,0,0),a.globalCompositeOperation="destination-over"):a.globalCompositeOperation="source-over",a.drawImage(c.current,0,0),_(),r=requestAnimationFrame(f);case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}}),[e.bodyPixNeuralNetwork,c,k,i,s,g,S,A,_]),Object(r.jsxs)("div",{className:"VideoPlayer",children:[Object(r.jsxs)("div",{className:"VideoPlayer-stats",children:[Object(r.jsxs)("span",{children:[Math.round(N)," fps"]})," (",Object(r.jsxs)("span",{children:["inference ",E,"ms"]}),","," ",Object(r.jsxs)("span",{children:["post-processing ",P,"ms"]}),")"]}),Object(r.jsx)("video",{ref:c,width:i,height:s,autoPlay:!0,playsInline:!0,controls:!1,hidden:!0,onLoadedData:function(){return h(!0)},onAbort:function(){return h(!1)}}),Object(r.jsx)("img",{ref:n,src:b,alt:"",hidden:!0}),Object(r.jsx)("canvas",{ref:t,className:"VideoPlayer-video",width:i,height:s}),Object(r.jsxs)("div",{className:"VideoPlayer-controls",children:[Object(r.jsx)(v,{iconName:"do_not_disturb",isActivated:"none"===k,onClick:function(){return C("none")}}),Object(r.jsx)(v,{iconName:"blur_on",isActivated:"blur"===k,onClick:function(){return C("blur")}}),Object(r.jsx)(v,{iconName:"image",isActivated:"image"===k,onClick:function(){return C("image")}})]})]})},m=n(233),g=n(253);var h=function(){var e=Object(a.useState)(null),t=Object(d.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){function e(){return(e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Loading TensorFlow.js and BodyPix segmentation model"),e.next=3,g.a();case 3:return e.t0=r,e.next=6,m.a();case 6:e.t1=e.sent,(0,e.t0)(e.t1),console.log("TensorFlow.js and BodyPix loaded");case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),n};var x=function(){var e=h();return e&&Object(r.jsx)(O,{bodyPixNeuralNetwork:e})},w=(n(280),function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,282)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))});i.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(x,{})}),document.getElementById("root")),w()}},[[281,1,2]]]);
//# sourceMappingURL=main.8dfc382b.chunk.js.map